<!DOCTYPE html>
<html lang="az">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cihaza Uyƒüun S√ºr…ôtli Banana Oyunu</title>
    <style>
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            background-color: #5D3FD3; 
            font-family: 'Comic Sans MS', cursive, sans-serif;
            color: #fff;
            padding: 20px;
        }

        #oyun-konteyner {
            text-align: center;
            padding: 30px;
            background-color: #7B68EE; 
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.5);
            border-radius: 20px;
            border: 5px solid #FFD700; 
            transition: transform 0.3s ease;
            width: 640px; 
            max-width: 90%; /* Mobil uyƒüunluq √º√ß√ºn */
        }

        #oyun-sah…ôsi {
            border: 5px dashed #FFD700; 
            background-color: #87CEEB; 
            cursor: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewport="0 0 100 100" style="fill:black;font-size:18px;"><text y="50%">üñêÔ∏è</text></svg>') 15 15, auto; 
            display: block;
            margin: 20px auto 15px;
            border-radius: 10px;
            touch-action: manipulation; /* Mobil cihazlarda gecikm…ôni azaldƒ±r */
        }

        h1 {
            color: #FFD700; 
            text-shadow: 2px 2px #5D3FD3;
            margin-bottom: 5px;
            font-size: 2.5em;
        }

        p {
            font-size: 1.5em;
            font-weight: bold;
            color: #F0FFFF; 
        }

        #xal-gosterici {
            color: #FF4500; 
            font-size: 1.2em;
        }
        
        #bar-konteyner {
            width: 100%;
            background-color: #333;
            border-radius: 5px;
            overflow: hidden;
            margin-top: 10px;
            border: 2px solid #fff;
        }

        #saƒülamlƒ±q-barƒ± {
            height: 25px;
            width: 100%; 
            background-color: #4CAF50; 
            transition: width 0.1s linear; 
            text-align: right;
            line-height: 25px;
            color: white;
            font-weight: bold;
            padding-right: 10px;
            box-sizing: border-box;
        }

        #oyun-bitdi-mesaj {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            color: #FFD700;
            display: none; 
            justify-content: center;
            align-items: center;
            flex-direction: column;
            z-index: 10;
            font-size: 3em;
            border-radius: 20px;
        }
        
        .klik-effekti {
            position: absolute;
            font-size: 20px;
            font-weight: bold;
            color: #FFD700;
            pointer-events: none;
            opacity: 1;
            animation: firlanma 0.8s ease-out forwards;
        }

        @keyframes firlanma {
            0% { transform: translateY(0) scale(1); opacity: 1; }
            100% { transform: translateY(-50px) scale(1.5); opacity: 0; }
        }
    </style>
</head>
<body>
    <div id="oyun-konteyner">
        <h1>üçå Banana Tƒ±klama Oyunu üéØ</h1>
        <p>Xal: <span id="xal-gosterici">0</span></p>
        
        <div id="bar-konteyner">
            <div id="saƒülamlƒ±q-barƒ±">Enerji</div>
        </div>

        <canvas id="oyun-sah…ôsi" width="600" height="400">
            Brauzeriniz Canvas elementini d…ôst…ôkl…ômir.
        </canvas>

        <div id="oyun-bitdi-mesaj">
            <h2>OYUN Bƒ∞TDƒ∞!</h2>
            <p>Sizin Xalƒ±nƒ±z: <span id="son-xal">0</span></p>
            <button onclick="window.location.reload()" style="padding: 10px 20px; font-size: 1.2em; cursor: pointer; border-radius: 5px;">Yenid…ôn Ba≈üla</button>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('oyun-sah…ôsi');
        const ctx = canvas.getContext('2d');
        const xalGosterici = document.getElementById('xal-gosterici');
        const saƒülamlƒ±qBarƒ± = document.getElementById('saƒülamlƒ±q-barƒ±');
        const oyunBitdiMesaj = document.getElementById('oyun-bitdi-mesaj');
        const sonXalGosterici = document.getElementById('son-xal');

        // Cihazƒ±n mobil olub olmadƒ±ƒüƒ±nƒ± yoxlayan funksiya
        function isMobile() {
            return /Mobi|Android|iPhone|iPad|Windows Phone/i.test(navigator.userAgent);
        }

        let xal = 0;
        let bananaX = 50;
        let bananaY = 50;
        const banana√ñl√ß√ºs√º = 50; 
        let sonYenil…ônm…ôVaxtƒ± = 0;

        // Cihazdan asƒ±lƒ± olaraq s√ºr…ôti t…ôyin et (ms)
        const mobilS√ºr…ôt = 200; // Telefon √º√ß√ºn 0.2 saniy…ô
        const desktopS√ºr…ôt = 400; // Komp√ºter √º√ß√ºn 0.4 saniy…ô
        const yenil…ônm…ôAralƒ±ƒüƒ± = isMobile() ? mobilS√ºr…ôt : desktopS√ºr…ôt; 

        let firlanmaBucaƒüƒ± = 0;
        const firlanmaS√ºr…ôti = 0.1;

        let cariBarD…ôy…ôri = 100; 
        const azalmaS√ºr…ôti = 0.05; 
        const artƒ±rmaD…ôy…ôri = 40; 
        let oyunAktiv = true;

        function muzu√á…ôk() {
            ctx.save();
            const m…ôrk…ôzX = bananaX + banana√ñl√ß√ºs√º / 2;
            const m…ôrk…ôzY = bananaY + banana√ñl√ß√ºs√º / 2;
            ctx.translate(m…ôrk…ôzX, m…ôrk…ôzY);
            ctx.rotate(firlanmaBucaƒüƒ±);
            ctx.translate(-m…ôrk…ôzX, -m…ôrk…ôzY);

            ctx.font = `${banana√ñl√ß√ºs√º}px Arial`;
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';
            ctx.fillText('üçå', m…ôrk…ôzX, m…ôrk…ôzY);

            ctx.restore();
        }
        
        function t…ôsad√ºfiYer() {
            bananaX = Math.random() * (canvas.width - banana√ñl√ß√ºs√º);
            bananaY = Math.random() * (canvas.height - banana√ñl√ß√ºs√º);
        }

        function yaratKlikEffekti(x, y) {
            const effekt = document.createElement('div');
            effekt.textContent = '+1';
            effekt.classList.add('klik-effekti');
            
            const rect = canvas.getBoundingClientRect();
            effekt.style.left = (rect.left + x + window.scrollX) + 'px';
            effekt.style.top = (rect.top + y + window.scrollY) + 'px';

            document.body.appendChild(effekt);

            effekt.addEventListener('animationend', () => {
                effekt.remove();
            });
        }

        function barƒ±Yenil…ô() {
            if (!oyunAktiv) return;

            cariBarD…ôy…ôri -= azalmaS√ºr…ôti;

            if (cariBarD…ôy…ôri < 0) {
                cariBarD…ôy…ôri = 0;
            }

            saƒülamlƒ±qBarƒ±.style.width = cariBarD…ôy…ôri + '%';
            saƒülamlƒ±qBarƒ±.textContent = `Enerji (${Math.round(cariBarD…ôy…ôri)}%)`;
            
            if (cariBarD…ôy…ôri < 25) {
                saƒülamlƒ±qBarƒ±.style.backgroundColor = '#FF4500'; 
            } else if (cariBarD…ôy…ôri < 50) {
                saƒülamlƒ±qBarƒ±.style.backgroundColor = '#FFD700'; 
            } else {
                saƒülamlƒ±qBarƒ±.style.backgroundColor = '#4CAF50'; 
            }

            if (cariBarD…ôy…ôri <= 0) {
                oyunAktiv = false;
                oyunuBitir();
            }
        }

        function oyunuBitir() {
            sonXalGosterici.textContent = xal;
            oyunBitdiMesaj.style.display = 'flex';
            canvas.style.opacity = '0.3';
        }


        function yenil…ô(cariVaxt) {
            if (!oyunAktiv) return;

            ctx.clearRect(0, 0, canvas.width, canvas.height);

            barƒ±Yenil…ô();

            firlanmaBucaƒüƒ± += firlanmaS√ºr…ôti;

            if (cariVaxt - sonYenil…ônm…ôVaxtƒ± > yenil…ônm…ôAralƒ±ƒüƒ±) {
                t…ôsad√ºfiYer();
                sonYenil…ônm…ôVaxtƒ± = cariVaxt;
            }

            muzu√á…ôk();

            requestAnimationFrame(yenil…ô);
        }

        canvas.addEventListener('click', function(e) {
            if (!oyunAktiv) return;

            const rect = canvas.getBoundingClientRect();
            const klikX = e.clientX - rect.left;
            const klikY = e.clientY - rect.top;

            const tolerantlƒ±q = 5;
            if (
                klikX >= bananaX - tolerantlƒ±q &&
                klikX <= bananaX + banana√ñl√ß√ºs√º + tolerantlƒ±q &&
                klikY >= bananaY - tolerantlƒ±q &&
                klikY <= bananaY + banana√ñl√ß√ºs√º + tolerantlƒ±q
            ) {
                xal++;
                xalGosterici.textContent = xal;
                
                cariBarD…ôy…ôri += artƒ±rmaD…ôy…ôri;
                if (cariBarD…ôy…ôri > 100) {
                    cariBarD…ôy…ôri = 100;
                }

                yaratKlikEffekti(klikX, klikY);

                t…ôsad√ºfiYer();
                sonYenil…ônm…ôVaxtƒ± = performance.now();
            }
        });
        
        // Mobil cihazlar √º√ß√ºn toxunma (touch) hadis…ôsini …ôlav…ô et
        canvas.addEventListener('touchstart', function(e) {
            e.preventDefault(); // Default toxunma h…ôr…ôk…ôtl…ôrini dayandƒ±r (scroll kimi)
            const touch = e.touches[0];
            
            // Toxunma hadis…ôsini klik hadis…ôsin…ô √ßevir…ôr…ôk eyni m…ôntiqi t…ôtbiq edirik
            canvas.dispatchEvent(new MouseEvent('click', {
                clientX: touch.clientX,
                clientY: touch.clientY
            }));
        });

        t…ôsad√ºfiYer(); 
        yenil…ô(0); 
    </script>
</body>
</html>